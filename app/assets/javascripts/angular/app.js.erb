'use strict';

angular.module('journals', 
  ['journals.people', 'journals.editInPlace', 'journals.filters', 'journals.pagination', 'journals.onType',
  'journals.groups', 'journals.modals']).
  
  config(['$locationProvider', '$httpProvider', function($locationProvider, $httpProvider) {
    $locationProvider.html5Mode(true);

    $httpProvider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content');
    $httpProvider.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';
  }]).
  
  config(['$routeProvider', function($routeProvider) {
    $routeProvider.

      when('/login', {redirectTo: '/'}).

      when('/', {redirectTo: '/people'}).

      when('/people', {templateUrl: '<%= asset_path("people.html") %>', controller: 'PeopleCtrl', reloadOnSearch: false, filterName: 'Students and teachers'}).

      when('/people/archived', {templateUrl: '<%= asset_path("people.html") %>', controller: 'PeopleCtrl', reloadOnSearch: false, filterName: 'Archived students and teachers'}).

      when('/teachers', {templateUrl: '<%= asset_path("people.html") %>', controller: 'PeopleCtrl', reloadOnSearch: false, filterName: 'Teachers'}).

      when('/teachers/:id', {templateUrl: '<%= asset_path("people.html") %>', controller: 'PeopleCtrl'}).

      when('/students', {templateUrl: '<%= asset_path("people.html") %>', controller: 'PeopleCtrl', reloadOnSearch: false, filterName: 'Students'}).

      when('/students/:id', {templateUrl: '<%= asset_path("people.html") %>', controller: 'PeopleCtrl'}).

      when('/guardians', {redirectTo: '/page-not-found'}).

      when('/guardians/:id', {templateUrl: '<%= asset_path("people.html") %>', controller: 'PeopleCtrl'}).

      when('/page-not-found', {templateUrl: '<%= asset_path("404.html") %>'}).

      otherwise({redirectTo: '/page-not-found'});
  }]);