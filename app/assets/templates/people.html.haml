%h2 {{pageTitle || "People"}}

%section#upper-bar
  %input#search{ "placeholder"=>"Enter search term", "name"=>"search", "ng-model"=>"search", "on-type"=>"doSearch()", "autocomplete"=>"off"}

  .add.menu
    %p.title Add
    
    %ul
      %li
        %a Add teacher
      %li
        %a Add student
      %li
        %a Manage groups

  %p.label Viewing

  .viewing.menu
    %p.title {{filterName}}

    %ul
      %li{"ng-hide" => "filterName == 'Students and teachers'"}
        %a{href: "/people"} Students and teachers
      %li{"ng-hide" => "filterName == 'Students'"}
        %a{href: "/students"} Students
      %li{"ng-hide" => "filterName == 'Teachers'"}
        %a{href: "/teachers"} Teachers
      %li{"ng-hide" => "filterName == 'Archived students and teachers'"}
        %a{href: "/people/archived"} Archived students and teachers

  .clear-left

%article.profile{ "ng-repeat"=>"person in people" }
  %header.profile-header
    %heading-field{ "parent"=>"person", "field-name"=>"full_name" }

    %p.type{ "ng-show"=>"person.type == 'teachers'" }
      {{person.type | simpleSingularize | capitalize}}

    .clear-left

  %profile-fields.main-profile-fields{ "parent"=>"person" }

  .guardians{ "ng-show"=>"person.type == 'students'" }
    .guardian{ "ng-repeat"=>"guardian in person.guardians" }
      
      %header.guardian-header
        %small-heading-field{ "parent"=>"guardian", "field-name"=>"full_name" }
        .clear-left

      %profile-fields.guardian-profile-fields{ "parent"=>"guardian" }

.content-block{ "ng-hide"=>"people.length" }
  %p No matching people were found.

%pagination{ "total-pages"=>"totalPages", "current-page"=>"currentPage" }

/ %header.profile-header
/   %h3= profile.full_name
/   - if profile.is_a? Teacher
/     %p.type Teacher
    

/   !!
/   - if can? :administrate, profile
/     = render 'shared/profile/administrate_menu', profile: profile
/   !!

/   .clear-left

/ .main-profile-fields
/   - profile.class.fields.each do |field|
/     = render 'shared/profile/field', field_data: field, field_value: profile.send(field[:function])

/   - if can? :update, profile
/     .edit
/       = link_to "Edit profile", edit_profile_path(profile), class: 'edit-link'


/ - if profile.is_a? Student
/   .guardians
/     !!
/     - if can? :create, Guardian
/       = link_to "Add guardian", new_student_guardian_path(profile), class: "add-guardian"
/     !!

/     - profile.guardians.each do |guardian|
/       = render "shared/profile/guardian", guardian: guardian, student: profile

/ !!
/ %footer.profile-footer
/   - if profile.is_a? Student
/     .groups
/       = render "shared/profile/groups", student: profile

/     .mentors
/       = render "shared/profile/mentors", student: profile

/   - if profile.is_a? Teacher
/     .mentees
/       = render "shared/profile/mentees", teacher: profile
/ !!